# API для CRUD запросов управления пользователями
### Инструкция по разворачиванию приложения на локальном компьютере

Для установки данного приложения вам необходимо в необходимой папке создать запустить bash-скрипт:

```sh
#!/bin/bash
mkdir crud-test && cd crud-test
git clone https://github.com/Philip-spb/DRF_USER_CRUD.git
python3 -m venv venv
source venv/bin/activate
cd DRF_USER_CRUD
pip install -r requirements.txt
python3 manage.py migrate
python3 manage.py createsuperuser --username admin --email admin@example.com --noinput
python3 manage.py changepassword admin
python3 manage.py runserver
```

Данный скрипт создаст виртуальное окружение Python, загрузит исходники приложенияи установит необходимые зависимости. Также выполнятся необходимые миграции и создастся запрос на создание суперпользователя `admin`, вам необходимо только указать для него пароль. После этого скрипт запустит тестовый сервер.

## Документация по API 
### Получение токена

Для получения токена необходимо отправить POST запрос с данными вашего пользователя системы по адресу http://127.0.0.1:8000/api/login/

```
{
    "username": "admin",
    "password": "ваш_пароль"
}
```

Если вы указали верные данные то вы получите следующие данные:

```
{
    "token": "ваш_секретный_токен"
}
```

В дальнейшем этот токен необходимо отправлять в заголовках серверу при каждом запросе к доступному только администраторам функционалу

```
Authorization: Token ваш_секретный_токен
```

Также нужно обязательно передавать следующий заголовок при отправке JSON запросов:

```
Content-Type: application/json
```

### Работа с CRUD API

Все CRUD запросы необходимо отправлять на адрес `http://127.0.0.1:8000/api/users/`

**Список всех пользователей:**

GET запрос `http://127.0.0.1:8000/api/users/`

**Создание нового пользователя:**

POST запрос `http://127.0.0.1:8000/api/users/`

```json
    {
        "username": "new_user",
        "is_active": "true",
        "password": "A123123123"
    }
```
*Поля username, is_active и password обязательны для заполнения*

**Просмотр существующего пользователя:**

GET запрос `http://127.0.0.1:8000/api/users/{id}`

**Внесение изменений в данные существующего пользователя:**

PUT запрос `http://127.0.0.1:8000/api/users/{id}`

```json
    {
        "username": "new_user",
        "is_active": "true",
        "password": "A123123123"
    }
```

**Внесение частичных изменений в данные существующего пользователя:**

PATCH запрос `http://127.0.0.1:8000/api/users/{id}`

```json
    {
        "is_active": "false"
    }
```

**Удаление существующего пользователя:**

DELETE запрос `http://127.0.0.1:8000/api/users/{id}`

## Тестирование функций CRUD

Для автоматического тестирования работы CRUD запросов необходимо выполнить команду `python3 manage.py test`

Данные тесты последовательно проверяют все описанные возможности системы и анализируют ответы как на корректные, так и некорректные запросы к API.